/* TOKEN YANG SUDAH TERPAKAI 
* bfwkbcsk, zaQunxlwAp, WKWK, bfwkbcskhjihhifb, ANJINGPEPEK
*/



// === DATA POST ===
const posts = [
  // { statusL: "Public", folder: "stik", gambar: "img.jpg", judulLiv: "Judul", author: "Authoer", dateLiv: "2025-12-10", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  
  { statusL: "Public", folder: "stik52", gambar: "img.jpg", judulLiv: "Dragon Anakan", author: "Telegram", dateLiv: "2025-12-12", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik51", gambar: "img.jpg", judulLiv: "LOGO ABR", author: "ABR TEAM", dateLiv: "2025-12-12", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik50", gambar: "img.jpg", judulLiv: "LAMPU WINDOW", author: "Saluran WA", dateLiv: "2025-12-12", typeCar: "Altezza", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik49", gambar: "img.jpg", judulLiv: "Sticker Pack", author: "Saluran WA", dateLiv: "2025-12-11", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik48", gambar: "img.jpg", judulLiv: "Mikey Sumedang", author: "garage kryzx", dateLiv: "2025-12-11", typeCar: "S15", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik47", gambar: "img.jpg", judulLiv: "Sticker Pack", author: "Saluran WA", dateLiv: "2025-12-10", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik46", gambar: "img.jpg", judulLiv: "Sticker Pack", author: "Saluran WA", dateLiv: "2025-12-10", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik45", gambar: "img.jpg", judulLiv: "Gengar Pokemon", author: "Saluran WA", dateLiv: "2025-12-10", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik44", gambar: "img.jpg", judulLiv: "Plat Number", author: "Saluran WA", dateLiv: "2025-12-08", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik43", gambar: "img.jpg", judulLiv: "Kap Mesin", author: "Saluran WA", dateLiv: "2025-12-10", typeCar: "S15", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik42", gambar: "img.jpg", judulLiv: "Tail Light", author: "Saluran WA", dateLiv: "2025-12-10", typeCar: "S13", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik41", gambar: "img.jpg", judulLiv: "Sticker Pack", author: "Saluran WA", dateLiv: "2025-12-10", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik40", gambar: "img.jpg", judulLiv: "Faith Fulne 225", author: "Kyotose", dateLiv: "2025-12-10", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik39", gambar: "img.jpg", judulLiv: "SexyStyle", author: "frl012", dateLiv: "2025-12-07", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik38", gambar: "img.jpg", judulLiv: "Sticker Pack", author: "noobyitashamake", dateLiv: "2025-12-11", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik37", gambar: "img.jpg", judulLiv: "LOGO ABR", author: "ABR TEAM", dateLiv: "2025-11-10", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik36", gambar: "img.jpg", judulLiv: "Kata Kata", author: "Yoga", dateLiv: "2025-12-07", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik35", gambar: "img.jpg", judulLiv: "Tribal", author: "Saluran WA", dateLiv: "2025-12-03", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik34", gambar: "img.jpg", judulLiv: "Tribal", author: "Saluran WA", dateLiv: "2025-12-03", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik33", gambar: "img.jpg", judulLiv: "Tribal", author: "Saluran WA", dateLiv: "2025-12-03", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik32", gambar: "img.jpg", judulLiv: "Tribal", author: "Saluran WA", dateLiv: "2025-12-03", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik31", gambar: "img.png", judulLiv: "Anime", author: "TELE", dateLiv: "2025-12-03", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik30", gambar: "img.jpg", judulLiv: "Anime", author: "TELE", dateLiv: "2025-12-03", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik29", gambar: "img.jpg", judulLiv: "Anime", author: "TELE", dateLiv: "2025-12-03", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik28", gambar: "img.jpg", judulLiv: "Boneka", author: "RACLE LIGHTNING", dateLiv: "2025-11-18", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik27", gambar: "img.jpg", judulLiv: "BANNER", author: "RACLE LIGHTNING", dateLiv: "2025-11-08", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik26", gambar: "img.png", judulLiv: "Anime", author: "TELEGRAM", dateLiv: "2025-11-04", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik25", gambar: "img.png", judulLiv: "WINDOW BILED", author: "STYLE HEHE", dateLiv: "2025-10-23", typeCar: "S15", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik24", gambar: "img.jpg", judulLiv: "PLAT DK", author: "RACLE LIGHTNING", dateLiv: "2025-11-02", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik23", gambar: "img.jpg", judulLiv: "ARDA $TYLE", author: "HANJIN", dateLiv: "2025-11-04", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik22", gambar: "img.jpg", judulLiv: "SUPREME", author: "TPAXAJI", dateLiv: "2025-11-08", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik21", gambar: "img.jpg", judulLiv: "BUSTERCUP", author: "HANJIN", dateLiv: "2025-11-02", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik20", gambar: "img.jpg", judulLiv: "Atap Carbon", author: "Frl.satnic", dateLiv: "2025-11-01", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik19", gambar: "img.png", judulLiv: "Itasha", author: "Roadsidee", dateLiv: "2025-11-07", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik18", gambar: "img.jpg", judulLiv: "ABZAD", author: "fckinglvu.fr", dateLiv: "2025-11-07", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik17", gambar: "img.jpg", judulLiv: "ABZAD", author: "fckinglvu.fr", dateLiv: "2025-11-07", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik16", gambar: "img.jpg", judulLiv: "ABZAD", author: "fckinglvu.fr", dateLiv: "2025-11-07", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik15", gambar: "img.jpg", judulLiv: "Sticker Pack", author: "TAKASHI", dateLiv: "2025-11-02", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik14", gambar: "img.jpg", judulLiv: "Sticker Pack", author: "Discord", dateLiv: "2025-10-30", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik13", gambar: "img.jpg", judulLiv: "MATERNAL", author: "Unknown", dateLiv: "2025-11-03", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik12", gambar: "img.jpg", judulLiv: "Carbon", author: "PSKN SENYAP", dateLiv: "2025-10-31", typeCar: "ALTEZZA", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik11", gambar: "img.jpg", judulLiv: "Night Runner", author: "Alchachofa", dateLiv: "2025-10-19", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik10", gambar: "img.png", judulLiv: "Sticker Pack", author: "IrlCarGallerys", dateLiv: "2025-10-30", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik9", gambar: "img.png", judulLiv: "Logo TikTok", author: "Michael (YT)", dateLiv: "2025-10-29", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik8", gambar: "img.jpg", judulLiv: "Logo Instagram", author: "REBYY x Z", dateLiv: "2025-10-29", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik7", gambar: "img.jpg", judulLiv: "Lampu Belakang", author: "Pastebin", dateLiv: "2025-10-28", typeCar: "GT86", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik6", gambar: "img.jpg", judulLiv: "Banner PSKN SENYAP", author: "PSKN SENYAP", dateLiv: "2025-10-26", typeCar: "ALTEZZA", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik5", gambar: "img.jpg", judulLiv: "Headlight & Taillight", author: "JDM Automotive", dateLiv: "2025-10-23", typeCar: "RX7", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik4", gambar: "img.jpg", judulLiv: "Lampu Belakang Rainbow", author: "SYIFA23", dateLiv: "2025-10-19", typeCar: "GT86", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik3", gambar: "img.png", judulLiv: "MESIN 2JZ", author: "Pastebin", dateLiv: "2025-10-10", typeCar: "S13", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik2", gambar: "img.jpg", judulLiv: "Sponsor Pack", author: "X", dateLiv: "2025-10-10", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" },
  { statusL: "Public", folder: "stik1", gambar: "img.jpg", judulLiv: "Nitrogen", author: "Salsabila", dateLiv: "2025-09-27", typeCar: "Available", body: "body.json", window: "window.json", aspekRasio: "16/9" }

  ];


const postContainer = document.getElementById("post-container");
const tokenInput = document.getElementById("tokenInput");
const submitToken = document.getElementById("submitToken");
const tokenStatus = document.getElementById("tokenStatus");

const ownerAGS = "Arda Style";
const validTokens = ["AGSJAYA", "AGSTEAM"];


// === SORT DEFAULT (untuk awal & reset) ===
// Urut terbaru ke terlama (tanpa mengubah posts asli)
let defaultSorted = [...posts].sort((a, b) => new Date(b.dateLiv) - new Date(a.dateLiv));


// === RENDER POSTS (TIDAK DIUBAH) ===
function renderPosts(showButtons = false, custom = null) {
  postContainer.innerHTML = "";
  const list = custom || defaultSorted;

  list.forEach((post, i) => {

    let statusIcon = {
      Public: "success",
      Sale: "warning",
      Premium: "info",
      Private: "dark"
    }[post.statusL] || "secondary";

    postContainer.innerHTML += ` 
      <div class="col-xl-3 col-md-6">
        <div class="card position-relative">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-lg-4 image-container container-img-badge position-relative">
                <span class="badge badge-soft-${statusIcon} position-absolute badge-kiri">${post.statusL}</span>
                <i class="bi bi-heart heart-icon position-absolute heart-kanan text-${statusIcon}" data-target="like${post.folder}"></i>
                <img src="stik/${post.folder}/${post.gambar}" alt="${post.judulLiv}" class="img-fluid mx-auto d-block" style="aspect-ratio: ${post.aspekRasio}; object-fit: cover;" loading="lazy" referrerpolicy="no-referrer">
                <div class="position-absolute bottom-0 start-50 translate-middle-x text-white opacity-25 p-1 fs-10">&copy; <span class="copyright2">${ownerAGS}</span></div>
                <div class="opacity-75">
                  <div class="profile-badge ms-3">
                    <img src="assets/img/kaiadmin/icon.png" alt="Profile Admin">
                    <span class="copyright2">${ownerAGS}</span>
                    <i class='bx bxs-badge-check text-info verified'></i>
                  </div>
                </div>
              </div> 
            </div>
            <h5 class="card-title mb-3">${post.judulLiv}</h5>
            <div class="d-flex align-items-center mb-1 text-muted small fw-semibold">
              <i class="bi bi-person-circle me-2"></i>
              <span>Author: ${post.author}</span>
            </div>
            <div class="d-flex align-items-center mb-1 text-muted small fw-semibold">
              <i class="bi bi-calendar3 me-2"></i>
              <span>Date: ${post.dateLiv}</span>
            </div>
            <div class="d-flex align-items-center text-muted small fw-semibold">
              <i class="bi bi-car-front-fill me-2"></i>
              <span>Type Car: ${post.typeCar}</span>
            </div>
            <div class="mt-3 bg-light-subtle rounded-bottom text-center">
              ${showButtons ? `<div class="gap-1 hstack">
                <button class="btn btn-black w-100" onclick="openJSON(${i}, 'body')">
                  <i class="fa fa-code me-1"></i>Body
                </button>
                <button class="btn btn-black w-100" onclick="openJSON(${i}, 'window')">
                  <i class="fa fa-code me-1"></i>Window
                </button>
              </div>`: `<p class="text-warning small mt-2">Masukkan token untuk membuka tombol</p>`}
            </div>
          </div>
        </div>
      </div>
    `;
  });
}

renderPosts(false); // awalnya tanpa tombol


// === CEK TOKEN (TIDAK DIUBAH) ===
submitToken.addEventListener("click", () => {
  const userToken = tokenInput.value.trim();
  if (validTokens.includes(userToken)) {
    tokenStatus.textContent = "Token benar! Tombol sudah terbuka.";
    tokenStatus.classList.add("text-soft-success");
    renderPosts(true);
  } else {
    tokenStatus.textContent = "Token Salah, Coba Lagi!";
    tokenStatus.classList.add("text-danger");
  }
});



// === FUNGSI OPEN JSON (LANGSUNG DOWNLOAD) ===
function openJSON(index, type) {
  const getPost = posts[index];
  // Jika bukan Public
  if (getPost.statusL !== "Public") {
    window.open("404.html", "_blank");
    return;
  }
  // Nama file asli
  const file = type === "body" ? getPost.body : getPost.window;
  // Lokasi file di folder
  const url = `stik/${getPost.folder}/${file}`;
  // === AUTO NAMA DOWNLOAD ===
  // Ambil judul, ubah jadi aman untuk nama file
  const safeTitle = getPost.judulLiv.replace(/[^a-z0-9\- ]/gi, "").replace(/ /g, "_");
  // Hasil nama file akhir → Dragon_Anakan-body.json
  const downloadName = `${safeTitle}-${type}.json`;
  // Buat link download
  const a = document.createElement("a");
  a.href = url;
  a.download = downloadName;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}






// ======================================================
// === FILTER SYSTEM (BARU DITAMBAH DI BAWAH INI) =======
// ======================================================

// TANGGAL TERBARU
function filterNewEst() {
  const sorted = [...posts].sort((a, b) => new Date(b.dateLiv) - new Date(a.dateLiv));
  renderPosts(true, sorted);
}

// TANGGAL TERLAMA
function filterOldEst() {
  const sorted = [...posts].sort((a, b) => new Date(a.dateLiv) - new Date(b.dateLiv));
  renderPosts(true, sorted);
}

// SALE
function filterSale() {
  const filtered = posts.filter(p => p.statusL.toLowerCase() === "sale");
  renderPosts(true, filtered);
}

// PREMIUM
function filterPremium() {
  const filtered = posts.filter(p => p.statusL.toLowerCase() === "premium");
  renderPosts(true, filtered);
}

// Private
function filterPrivate() {
  const filtered = posts.filter(p => p.statusL.toLowerCase() === "private");
  renderPosts(true, filtered);
}

// PUBLIC (khusus sorting terbaru → lama)
function filterPublic() {
  const filtered = posts
    .filter(p => p.statusL.toLowerCase() === "public")
    .sort((a, b) => new Date(b.dateLiv) - new Date(a.dateLiv));

  renderPosts(true, filtered);
}

// RESET FILTER → urut seperti default (terbaru → lama)
function resetFilter() {
  renderPosts(true, defaultSorted);
}



// === LIKE SYSTEM TETAP ===
document.addEventListener("click", (e) => {
  const heart = e.target.closest(".heart-icon");
  if (heart) {
    const id = heart.getAttribute("data-target");
    const isLiked = heart.classList.contains("bi-heart-fill");
    if (isLiked) {
      heart.classList.replace("bi-heart-fill", "bi-heart");
      localStorage.setItem(`like-${id}`, "false");
    } else {
      heart.classList.replace("bi-heart", "bi-heart-fill");
      localStorage.setItem(`like-${id}`, "true");
    }
  }
});

window.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".heart-icon").forEach(heart => {
    const id = heart.getAttribute("data-target");
    if (localStorage.getItem(`like-${id}`) === "true") {
      heart.classList.replace("bi-heart", "bi-heart-fill");
    }
  });
});